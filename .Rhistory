group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Line Chart: Food Accessibility by LGA
fish_data <- read.csv("C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//fishing_data.csv")
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2) +
geom_text(aes(label = count), vjust = -0.5, size = 2, color = "black") +
labs(
title = "Fishing Practice Changes by LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Line Chart: Food Accessibility by LGA
fish_data <- read.csv("C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//fishing_data.csv")
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 10) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Line Chart: Food Accessibility by LGA
fish_data <- read.csv("C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//fishing_data.csv")
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Line Chart: Food Accessibility by LGA
fish_data <- read.csv("C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//fishing_data.csv")
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by Due to Conflict LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Line Chart: Food Accessibility by LGA
fish_data <- read.csv("C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//fishing_data.csv")
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by Due to Conflict LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.3, face = "bold")
)
# Line Chart: Food Accessibility by LGA
fish_data <- read.csv("C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//fishing_data.csv")
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by Due to Conflict LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 10, face = "bold")
)
farm2_summary <- fish_data %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by Due to Conflict LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
view(fish_data)
?glm
fish <- glm(fishing_practices_changed_10yrs ~ conflict_with_farmers_herders, data = fish_data, family = "binomial")
table(fish_data$fishing_practices_changed_10yrs)
summary(fish_data)
summary(fish_data$fishing_practices_changed_10yrs)
table(is.na(fish_data$fishing_practices_changed_10yrs)
)
fish_data$fishchangeTF <- fish_data$fishing_practices_changed_10yrs == "Yes"
table(fish_data$fishchangeTF)
table(as.numeric(fish_data$fishchangeTF))
fish <- glm(fishchangeTF ~ conflict_with_farmers_herders, data = fish_data, family = "binomial")
summary(fish)
summary(lga)
summary(fish_data$lga)
table(fish_data$lga)
fish <- glm(fishchangeTF ~ lga, data = fish_data, family = "binomial")
fish2 <- glm(fishchangeTF ~ lga, data = fish_data, family = "binomial")
fish_lga <- glm(fishchangeTF ~ lga, data = fish_data, family = "binomial")
fish_lga <- glm(conflict_with_farmers_herders ~ lga, data = fish_data, family = "binomial")
fish_lga <- glm(conflict_with_farmers_herdersTF ~ lga, data = fish_data, family = "binomial")
fish_lga <- glm(fishchangeTF ~ lga, data = fish_data, family = "binomial")
fish_conflict <- glm(conflict_with_farmers_herdersTF ~ lga, data = fish_data, family = "binomial")
table(fish_data$conflict_with_farmers_herders)
view(conflict_with_farmers_herders)
fish_conflict <- glm(conflict_with_farmers_herdersTF ~ lga, data = fish_data, family = "binomial")
fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data, family = "binomial")
fish_data$fishconflictTF <- fish_data$conflict_with_farmers_herders == "Yes"
fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data, family = "binomial")
fish_data$fishconflictTF <- fish_data$conflict_with_farmers_herders == "Yes"
fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data, family = "binomial")
anova(fish_conflict)
anova(fish_conflict,fish)
anova(fish_conflict)
ecp <- sum(farm_data$std_dependents >= farm_data$q5 &
farm_data$std_dependents <= farm_data$q95)/nrow(farm_data)
View(income_summary)
fish_data$fishconflictTF <- fish_data$conflict_with_farmers_herders == "Yes"
fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data, family = "binomial")
anova(fish_conflict)
# logical vector (converting to Logical)
fish_data$fishchangeTF <- fish_data$fishing_practices_changed_10yrs == "Yes"
fish <- glm(fishchangeTF ~ conflict_with_farmers_herders, data = fish_data, family = "binomial")
anova(fish_conflict, fish)
anova(fish_conflict + fish)
anova(fish_conflict)
a <- anova(fish_conflict)
table(a)
View(a)
# a <- anova(fish_conflict)
# table(a)
# View(a)
table(fish_data$conflict_with_farmers_herders)
fish_data_converted <- fish_data %>%
mutate(
food_security_change_farming2 = case_when(
food_security_change_farming == "Less food now" ~ "Yes",
TRUE ~ "No"
)
)
library(tidyverse)
library(brms)
library(emmeans)
library(posterior)
library(agridat)
library(lme4)
library(tidyverse)
library(emmeans)
library(brms)
library(posterior)
library(contrast)
library(glm)
fish_data_converted <- fish_data %>%
mutate(
food_security_change_farming2 = case_when(
food_security_change_farming == "Less food now" ~ "Yes",
TRUE ~ "No"
)
)
View(fish_data_converted)
fish_data_converted <- fish_data %>%
mutate(
food_security_change_fishing2 = case_when(
food_security_change_fishing == "Less food now" ~ "Yes",
TRUE ~ "No"
)
)
# logical vector (converting to Logical)
fish_data_converted$fishchangeTF <- fish_data_converted$fishing_practices_changed_10yrs == "Yes"
fish <- glm(fishchangeTF ~ conflict_with_farmers_herders, data = fish_data_converted, family = "binomial")
summary(fish)
table(fish_data_converted$lga)
fish_data_converted$fishconflictTF <- fish_data_converted$conflict_with_farmers_herders == "Yes"
model1_fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data_converted, family = "binomial")
anova(model1_fish_conflict)
fish_data_converted <- fish_data %>%
mutate(
food_security_change_fishing2 = case_when(
food_security_change_fishing == "Less food now" ~ "Less food",
TRUE ~ "Enough food"
)
)
farm2_summary <- fish_data_converted %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by Due to Conflict LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
# logical vector (converting to Logical)
fish_data_converted$fishchangeTF <- fish_data_converted$fishing_practices_changed_10yrs == "Yes"
fish <- glm(fishchangeTF ~ conflict_with_farmers_herders, data = fish_data_converted, family = "binomial")
summary(fish)
fish_data_converted$fishconflictTF <- fish_data_converted$conflict_with_farmers_herders == "Yes"
model1_fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data_converted, family = "binomial")
model2_fish_conflict <- glm(fishconflictTF ~ lga + food_security_change_fishing2, data = fish_data_converted, family = "binomial")
anova(model2_fish_conflict)
# Model 1
model1_fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data_converted, family = "binomial")
anova(model1_fish_conflict)
anova(model2_fish_conflict)
fish_data_converted <- fish_data %>%
mutate(
less_food_access_now = case_when(
food_security_change_fishing == "Less food now" ~ "Less food",
TRUE ~ "Enough food"
)
)
farm2_summary <- fish_data_converted %>%
filter(fishing_practices_changed_10yrs !="", lga !="") %>%
group_by(lga, fishing_practices_changed_10yrs) %>%
summarise(count = n(), .groups = "drop")
ggplot(farm2_summary, aes(x = lga,
y = count,
color = fishing_practices_changed_10yrs,
group = fishing_practices_changed_10yrs)) +
geom_line(linewidth = 1.2) +
geom_point(size = 3) +
geom_text(aes(label = count), vjust = -0.5, size = 3, color = "black") +
labs(
title = "Fishing Practice Changes by Due to Conflict LGA",
x = "LGAs",
y = "Number of Respondents",
color = "Fishing Practice Changed"
) +
theme_minimal(base_size = 14) +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "lightblue", color = NA),
plot.title = element_text(hjust = 0.5, face = "bold")
)
# logical vector (converting to Logical)
fish_data_converted$fishchangeTF <- fish_data_converted$fishing_practices_changed_10yrs == "Yes"
fish <- glm(fishchangeTF ~ conflict_with_farmers_herders, data = fish_data_converted, family = "binomial")
summary(fish)
model1_fish_conflict <- glm(fishconflictTF ~ lga, data = fish_data_converted, family = "binomial")
model2_fish_conflict <- glm(fishconflictTF ~ lga + food_security_change_fishing2, data = fish_data_converted, family = "binomial")
model2_fish_conflict <- glm(fishconflictTF ~ lga + less_food_access_now, data = fish_data_converted, family = "binomial")
anova(model2_fish_conflict)
# Model 0: Response Variable (Fishing affected by coflict), Predictors (LGA )
modelo_fish_conflict <- glm(fishconflictTF ~ 1, data = fish_data_converted, family = "binomial")
# Model 3:
anova(modelo_fish_conflict)
# Model 3:
model3_fish_conflict <- glm(fishconflictTF ~ lga + less_food_access_now + born_in_community, data = fish_data_converted, family = "binomial")
anova(model3_fish_conflict)
fish_data_converted$place_of_birth <- fish_data_converted$born_in_community == "Yes"
# Model 3:
model3_fish_conflict <- glm(fishconflictTF ~ lga + less_food_access_now + place_of_birth, data = fish_data_converted, family = "binomial")
anova(model3_fish_conflict)
anova(model3_fish_conflict)
anova(modelo_fish_conflict)
anova(model1_fish_conflict)
anova(model2_fish_conflict)
anova(model3_fish_conflict)
write.csv(all_anova, "write.xlsx(farm_ranged, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//anova_results.csv", row.names = FALSE)
write.csv(all_anova, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//anova_results.csv", row.names = FALSE)
# Run ANOVAs
anova1 <- anova(modelo_fish_conflict, test = "Chisq")
anova2 <- anova(model1_fish_conflict, test = "Chisq")
anova3 <- anova(model2_fish_conflict, test = "Chisq")
anova4 <- anova(model3_fish_conflict, test = "Chisq")
# Convert to data frames
df1 <- as.data.frame(anova1) df1$model <- "modelo_fish_conflict"
# Combine into one big table
all_anova <- rbind(df1, df2, df3, df4)
write.csv(all_anova, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//anova_results.csv", row.names = FALSE)
# Convert to data frames
df1 <- as.data.frame(anova1); df1$model <- "modelo_fish_conflict"
df2 <- as.data.frame(anova2); df2$model <- "model1_fish_conflict"
df3 <- as.data.frame(anova3); df3$model <- "model2_fish_conflict"
df4 <- as.data.frame(anova4); df4$model <- "model3_fish_conflict"
# Combine into one big table
all_anova <- rbind(df1, df2, df3, df4)
write.csv(all_anova, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//data//anova_results.csv", row.names = FALSE)
write.csv(all_anova, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//regression//anova_results.csv", row.names = FALSE)
table(
anova1 <- anova(modelo_fish_conflict, test = "Chisq")
anova2 <- anova(model1_fish_conflict, test = "Chisq")
anova1 <- anova(modelo_fish_conflict, test = "Chisq")
anova2 <- anova(model1_fish_conflict, test = "Chisq")
anova3 <- anova(model2_fish_conflict, test = "Chisq")
anova4 <- anova(model3_fish_conflict, test = "Chisq")
table(
anova1
anova2
table(
anova1,
anova2,
anova3,
anova4
)
library(openxlsx)
wb <- createWorkbook()
addWorksheet(wb, "modelo_fish_conflict")
writeData(wb, "modelo_fish_conflict", df1)
addWorksheet(wb, "model1_fish_conflict")
writeData(wb, "model1_fish_conflict", df2)
addWorksheet(wb, "model2_fish_conflict")
writeData(wb, "model2_fish_conflict", df3)
addWorksheet(wb, "model3_fish_conflict")
writeData(wb, "model3_fish_conflict", df4)
saveWorkbook(wb, "anova_results.xlsx", overwrite = TRUE)
saveWorkbook(wb, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//regression//anova_results.csv", overwrite = TRUE)
saveWorkbook(wb, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//regression//anova_results", overwrite = TRUE)
saveWorkbook(wb, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//regression//anova_results.xlsx", overwrite = TRUE)
df1 <- as.data.frame(anova(model1_fish_conflict, test = "Chisq"))
df1$term <- rownames(df1); rownames(df1) <- NULL
df1 <- df1[, c("term", names(df1)[names(df1) != "term"])]
df1$model <- "modelo_fish_conflict"
df2 <- as.data.frame(anova(model1_fish_conflict, test = "Chisq"))
df2$term <- rownames(df2); rownames(df2) <- NULL
df2 <- df2[, c("term", names(df2)[names(df2) != "term"])]
df2$model <- "model1_fish_conflict"
df3 <- as.data.frame(anova(model2_fish_conflict, test = "Chisq"))
df3$term <- rownames(df3); rownames(df3) <- NULL
df3 <- df3[, c("term", names(df3)[names(df3) != "term"])]
df3$model <- "model2_fish_conflict"
df4 <- as.data.frame(anova(model3_fish_conflict, test = "Chisq"))
df4$term <- rownames(df4); rownames(df4) <- NULL
df4 <- df4[, c("term", names(df4)[names(df4) != "term"])]
df4$model <- "model3_fish_conflict"
# Combine all
all_anova <- rbind(df1, df2, df3, df4)
saveWorkbook(all_anova, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//regression//anova_results.xlsx", overwrite = TRUE)
write.xlsx(all_anova, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//regression//anova_results.xlsx", overwrite = TRUE)
write.xlsx(all_anova, "C://Users//User//OneDrive//Desktop//SLC_BAYES//SLCBayesProject//regression//anova_results.xlsx", overwrite = TRUE)
#___________________ANOVA FOR Model 1 to 4______________________#
anova(modelo_fish_conflict)
anova(model1_fish_conflict)
git remote add origin https://github.com/IsaJugudum/Group-1-BAYESIAN-Workshop-Practice.git
install.packages("githubr")
library(githubr)
git remote add origin https://github.com/IsaJugudum/Group-1-BAYESIAN-Workshop-Practice.git
install.packages("gitr")
install.packages("git2rdata")
